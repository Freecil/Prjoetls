do {
    do {
        $Software = Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, @{Name="DisplayIcon";Expression={$_.DisplayIcon.Split(',')[0]}}, InstallLocation, UninstallString

        foreach ($program in $Software) {
            $locatl = Test-Path -$program.InstallLocation
            $dislocal = Test-Path -$program.DisplayIcon
            if ( $null -ne  $program.InstallLocation -and $null -ne $locatl) {
                if ( $null -ne $program.DisplayIcon -and $null -ne $dislocal) {
                
        
                    $CorrectFolder = Split-Path -Path $program.DisplayIcon
                    Set-Location $CorrectFolder
                    Start-Process -FilePath $program.DisplayIcon 
                    Start-Sleep(5)
                }
            }
        }
       
    $loops++

    } until ($loops -eq 100)
    $loops = 0 
}until ($loops -eq 1000)
